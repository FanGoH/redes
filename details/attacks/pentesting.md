# Pentesting

Para probar un ataque sobre un sitio web (así como algunas vulnerabilidades comunes), se recurre a el proyecto de *Juice Shop* de la OWASP. Esta es una aplicación diseñada de manera de ser insegura, y tiene como objetivo iniciar en el proceso de reconocer vulnerabilidades, en el presente documento se exploran algunas, con apoyo de Burp

## Instalando Juice Shop

- Instalar nodejs (Juice Shop se encuentra disponible para la version 14 o posterior)
- Descargar los paquetes de Github [https://github.com/juice-shop/juice-shop/releases/tag/v15.0.0](https://github.com/juice-shop/juice-shop/releases/tag/v15.0.0), en este caso, la versión 15 para node 20.
- Descomprimir
- npm install y npm start

## Utilizando Burp Proxy

Parte de éstos ataques involucran la utilizacion de Burp Proxy para generar peticiones con informacion personalizada. Burp como una suite importante para manipular paquetes.

Una de las funcionalidades con las que cuenta es un navegador basado en Chromium que intercepta las peticiones, y permite modificarlas antes de enviarlas, esta se encuentrra dentro de Proxy > Intercept > intercept is off, y ya está listo para interceptar requests.

## Haciendo inyección SQL

- Abrimos la página de login, haciendo forwarding ![]()


- Rellenamos los datos con información dummy, para poder revisar como se mandan las solicitudoes
![]() y damos enviar

- Presionamos *Forward* hasta que la petición se encuentre en el interceptor

- Cambiamos el email por una sentencia SQL, que hará que se ignore la validación de usuario y contraseña, que sucede cuando la entrada no se encuetnra validada como debería

![]()

- Esto puede hacerse con cualquier cuenta, por ejemplo, entremos con la cuenta de "bender@juice-sh.op", modificando el email para ser bender@juice-sh.op' --, que es suficiente para generar el token




## Haciendo fuerza bruta sobre las contraseñas

Si bien es cierto que podemos utilizar mas técnicas de inyección, vamos a experimentar con la lista de contraseñas conocidas, una de esas listas es best1050 de Seclists, que puede buscarse en internet y descargar (por ejemplo [aqui](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/best1050.txt)), o con el paquete seclists.

Para hacer el ataque utilizando Burp:

- Buscamos la solicitud de login y la mandamos a intruder

![]()

- Modificamos el cuerpo de la petición para aceptar diferentes parametros de las contraseñas

- Cargamos la lista de best1050.txt seleccionando *load*

- Iniciamos el ataque, notar que la versión community tiene un tiempo de espera entre peticiones

- Buscamos la contraseña que generó un 200 como respuesta http, que es admin123

![]()

## Vulnerabilidades con FTP

El servidor cuenta con un ftp que permite la entrada de invitados, por lo que al visitar la ruta /ftp, encontramos


![]()


Ahora tratemos de descargar `package.json.bak`, (que puede contener informacion importante), y obtenemos la siguiente respuesta

![]()

Pero es posible rodear esta limitante con añadir una caracter malicioso en la URL


Y ya se vuelve posible


## Conclusiones

Estas son solo algunas vulnerabilidades presentes en Juice Shop, pero hacen muy claro como es que hay que preocuparse por garantizar la seguridad de nuestros servicios, ya que, procedimientos para hacer estos (y mas) ataques son muchos, por lo que vale la pena reflexionar sobre si se vuelve vulnerable nuestra aplicación